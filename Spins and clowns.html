<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Clown Slot Game</title>
<style>
  :root{
    --bg1:#151418;
    --bg2:#2b2a2f;
    --accent1:#ffcc00;
    --accent2:#ff6600;
    --panel:#0f0f12;
    --text:#f5efe6;
  }
  html,body{
    height:100%;
    margin:0;
    font-family:Inter,system-ui,Arial,sans-serif;
    background:linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--text);
    display:flex;
    justify-content:center;
    align-items:flex-start;
    -webkit-font-smoothing:antialiased;
    overflow-x:hidden;
  }
  .wrap{
    max-width:1100px;
    width:100%;
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    align-items:flex-start;
    gap:16px;
    padding:10px;
    box-sizing:border-box;
  }
  .left{
    width:240px;
    background:#111;
    border-radius:14px;
    padding:14px;
    box-shadow:0 4px 25px rgba(0,0,0,0.6);
    flex-shrink:0;
  }
  .left h3{margin:0 0 10px 0;font-size:18px;color:var(--accent1);text-align:center}
  .payout-row{display:flex;justify-content:space-between;padding:6px;border-radius:6px;margin-bottom:6px;background:rgba(255,255,255,0.03);font-size:13px}
  .balance{margin-top:8px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.03);text-align:center;font-weight:700;font-size:14px}

  .main{
    flex:1;
    display:flex;
    flex-direction:column;
    align-items:center;
    min-width:280px;
  }
  h1{margin:6px 0 10px 0;font-size:26px;letter-spacing:0.6px;text-align:center}
  .slot-frame{
    background:#000;
    padding:12px;
    border-radius:12px;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:8px;
    width:min(600px,95vw);
  }
  .cell{
    background:#111;
    border-radius:10px;
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
    border:2px solid rgba(255,255,255,0.05);
    aspect-ratio:1/1;
    transition:transform 220ms ease, box-shadow 220ms;
  }
  .cell img{max-width:90%;max-height:90%;display:block;border-radius:8px;pointer-events:none}
  .cell.win{transform:scale(1.05);box-shadow:0 0 25px rgba(255,220,0,0.8),0 0 60px rgba(255,120,0,0.2)}
  .controls{margin-top:12px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:center;width:100%}
  .bet-chips{display:flex;gap:10px}
  .chip{padding:8px 12px;border-radius:10px;background:#222;cursor:pointer;border:2px solid rgba(255,255,255,0.05);font-weight:700;font-size:14px}
  .chip.selected{outline:2px solid rgba(255,204,0,0.3)}
  .spin-btn{padding:10px 26px;border-radius:12px;background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#222;font-size:18px;font-weight:800;border:none;cursor:pointer;box-shadow:0 6px 18px rgba(255,102,0,0.2)}
  .spin-btn:disabled{opacity:0.5;cursor:not-allowed}
  .info-line{margin-top:6px;font-size:14px;color:rgba(255,255,255,0.85)}
  .message{margin-top:10px;font-size:18px;min-height:24px;color:var(--accent1);text-align:center}

  .popup{
    position:fixed;left:50%;top:20%;transform:translateX(-50%) scale(0.95);
    z-index:9999;pointer-events:none;opacity:0;transition:opacity .25s,transform .25s;
  }
  .popup.show{opacity:1;transform:translateX(-50%) scale(1)}
  .popup img{max-width:80vw;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,0.7)}

  @media (max-width:768px){
    .wrap{flex-direction:column;align-items:center}
    .left{width:90%;order:2}
    .slot-frame{width:90vw;gap:6px}
    .cell{aspect-ratio:1/1}
    .main{order:1}
    .spin-btn{padding:12px 40px;font-size:20px}
  }
</style>
</head>
<body>
<div class="wrap">
  <aside class="left">
    <h3>PAYOUT TABLE</h3>
    <div class="payout-row"><span>3 Clown Faces (Jackpot)</span><strong>50×</strong></div>
    <div class="payout-row"><span>3 Other Symbols</span><strong>10×</strong></div>
    <div class="payout-row"><span>2 Clown Faces</span><strong>3×</strong></div>
    <div class="payout-row"><span>Else</span><strong>Lose</strong></div>
    <div class="balance">
      Balance: <span id="balanceDisplay">1000</span> doublons
    </div>
  </aside>

  <main class="main">
    <h1>Clown Slot Game</h1>
    <div class="slot-frame" id="slotFrame">
      <div class="cell"></div><div class="cell"></div><div class="cell"></div>
      <div class="cell"></div><div class="cell"></div><div class="cell"></div>
      <div class="cell"></div><div class="cell"></div><div class="cell"></div>
    </div>
    <div class="controls">
      <div class="bet-chips">
        <div class="chip" data-bet="10">10</div>
        <div class="chip" data-bet="50">50</div>
        <div class="chip selected" data-bet="100">100</div>
      </div>
      <button id="spinBtn" class="spin-btn">SPIN</button>
    </div>
    <div class="info-line">Selected bet: <span id="selectedBet">100</span></div>
    <div class="message" id="message">Good luck!</div>
  </main>
</div>

<!-- Popups -->
<div id="jackpotPopup" class="popup">
  <img src="Jackpot sign.png" alt="Jackpot!">
</div>
<div id="winPopup" class="popup" style="top:30%">
  <img src="Feels_good_man.jpeg" alt="You win!">
</div>

<script>
const icons = [
  'KUfSTMv.jpeg','QTjoPgM.jpeg','JiEvroq.jpeg',
  'tank 1.png','icon 2.png','icon 3.png'
].map(i=>`https://peacejug.github.io/degenerateclowns/${encodeURIComponent(i)}`);

const spinSoundSrc = 'https://peacejug.github.io/degenerateclowns/spin.mp3';
const winSoundSrc = 'https://peacejug.github.io/degenerateclowns/win.mp3';
const jackpotSoundSrc = 'https://peacejug.github.io/degenerateclowns/jackpot.mp3';

const PAYOUTS={JACKPOT_3:50,OTHER_3:10,TWO_CLOWNS:3};
let balance=1000;
let selectedBet=100;
let spinning=false;

const cells=[...document.querySelectorAll('.cell')];
const chips=[...document.querySelectorAll('.chip')];
const spinBtn=document.getElementById('spinBtn');
const balanceEl=document.getElementById('balanceDisplay');
const selectedBetEl=document.getElementById('selectedBet');
const messageEl=document.getElementById('message');
const jackpotPopup=document.getElementById('jackpotPopup');
const winPopup=document.getElementById('winPopup');

function playSound(src,vol=1){try{const a=new Audio(src);a.volume=vol;a.play().catch(()=>{});return a;}catch{return null;}}
function refreshBalance(){balanceEl.textContent=balance;spinBtn.disabled=balance<selectedBet;}
function clearWins(){cells.forEach(c=>c.classList.remove('win'));}
function highlightWinCells(ix){ix.forEach(i=>cells[i]?.classList.add('win'));}
function showPopup(el,d=1000){el.classList.add('show');setTimeout(()=>el.classList.remove('show'),d);}
function rand(){return Math.floor(Math.random()*icons.length);}
function isClown(i){return i<=2;}

chips.forEach(ch=>ch.onclick=()=>{chips.forEach(c=>c.classList.remove('selected'));ch.classList.add('selected');selectedBet=+ch.dataset.bet;selectedBetEl.textContent=selectedBet;refreshBalance();});
refreshBalance();

function evaluate(g){
  for(let r=0;r<3;r++){const [a,b,c]=[g[r*3],g[r*3+1],g[r*3+2]];
    if(a===b&&b===c)return {mult:isClown(a)?PAYOUTS.JACKPOT_3:PAYOUTS.OTHER_3,type:isClown(a)?'jackpot':'win',ix:[r*3,r*3+1,r*3+2]};
  }
  for(let c=0;c<3;c++){const [a,b,d]=[g[c],g[c+3],g[c+6]];
    if(a===b&&b===d)return {mult:isClown(a)?PAYOUTS.JACKPOT_3:PAYOUTS.OTHER_3,type:isClown(a)?'jackpot':'win',ix:[c,c+3,c+6]};
  }
  if(g[0]===g[4]&&g[4]===g[8])return {mult:isClown(g[0])?PAYOUTS.JACKPOT_3:PAYOUTS.OTHER_3,type:isClown(g[0])?'jackpot':'win',ix:[0,4,8]};
  if(g[2]===g[4]&&g[4]===g[6])return {mult:isClown(g[2])?PAYOUTS.JACKPOT_3:PAYOUTS.OTHER_3,type:isClown(g[2])?'jackpot':'win',ix:[2,4,6]};
  const clowns=g.filter(isClown).length;
  if(clowns>=2){const ix=[];for(let i=0;i<g.length&&ix.length<2;i++)if(isClown(g[i]))ix.push(i);return {mult:PAYOUTS.TWO_CLOWNS,type:'win',ix};}
  return {mult:0,type:'none',ix:[]};
}

async function spin(){
  if(spinning||balance<selectedBet)return;
  spinning=true;clearWins();
  balance-=selectedBet;refreshBalance();
  messageEl.textContent='Spinning...';
  playSound(spinSoundSrc,0.9);
  const flicks=15;let count=0;const grid=[];
  const interval=setInterval(()=>{
    cells.forEach(c=>{c.innerHTML=`<img src="${icons[rand()]}">`;});
    count++;
    if(count>=flicks){
      clearInterval(interval);
      for(let i=0;i<9;i++){grid[i]=rand();cells[i].innerHTML=`<img src="${icons[grid[i]]}">`;}
      const res=evaluate(grid);
      if(res.type==='jackpot'){playSound(jackpotSoundSrc,0.05);showPopup(jackpotPopup,1200);highlightWinCells(res.ix);const w=selectedBet*res.mult;balance+=w;messageEl.textContent=`JACKPOT! +${w}`;}
      else if(res.type==='win'){playSound(winSoundSrc,0.8);showPopup(winPopup,900);highlightWinCells(res.ix);const w=selectedBet*res.mult;balance+=w;messageEl.textContent=`You win +${w}`;}
      else{messageEl.textContent=`You lost ${selectedBet}`;}
      refreshBalance();spinning=false;
    }
  },70);
}
spinBtn.onclick=spin;
document.addEventListener('keydown',e=>{if(e.code==='Space'){e.preventDefault();spin();}});
</script>
</body>
</html>
